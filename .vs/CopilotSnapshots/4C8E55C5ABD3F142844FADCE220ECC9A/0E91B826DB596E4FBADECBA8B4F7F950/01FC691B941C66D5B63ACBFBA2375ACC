@echo off
chcp 65001 >nul
echo.
echo ====================================
echo    🖥️ تطبيق سكني الدسكتوب 🖥️
echo ====================================
echo.

cd /d "%~dp0"

echo 📦 التحقق من تثبيت الاعتماديات...
if not exist "node_modules\electron" (
    echo 🔄 تثبيت اعتماديات Electron...
    npm install
    if errorlevel 1 (
        echo ❌ فشل في تثبيت الاعتماديات
        pause
        exit /b 1
    )
    echo ✅ تم تثبيت الاعتماديات بنجاح
) else (
    echo ✅ الاعتماديات مثبتة مسبقاً
)

echo.
echo 🚀 تشغيل تطبيق سكني الدسكتوب...
echo.
echo ⏳ انتظر قليلاً حتى يفتح التطبيق...
echo.

npm run electron-dev

if errorlevel 1 (
    echo.
    echo ❌ حدث خطأ في تشغيل التطبيق
    echo.
    echo 🔧 نصائح لحل المشكلة:
    echo    1. تأكد من تشغيل الأمر: npm install
    echo    2. تحقق من عدم تشغيل خادم آخر على المنفذ 8080
    echo    3. تأكد من وجود ملفات المشروع كاملة
    echo.
    pause
    exit /b 1
)

echo.
echo 👋 تم إغلاق التطبيق
pause