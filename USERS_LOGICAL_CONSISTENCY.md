# โ ุงูุชูุงูู ุงูููุทูู ุจูู ูุงุฌูุฉ ุงููุณุชุฎุฏููู ููุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ฏ ุงููุดููุฉ ุงูุณุงุจูุฉ
ูุงู ููุงู ุนุฏู ุชูุงูู ุจูู:
- **ุงููุงูุฐุฉ ุงูููุจุซูุฉ**: ุชุนุฑุถ ูุนูููุงุช ูุฎุชููุฉ
- **ุฌุฏูู ุงููุณุชุฎุฏููู**: ูุนุฑุถ ูุนูููุงุช ูุฎุชููุฉ
- **ุงูููุทู ุงูุจุฑูุฌู**: ูุณุชุฎุฏู ุญููู ูุฎุชููุฉ ููุญุธุฑ

## โ ุงูุญู ุงููุทุจู

### ๐ ููู ุญููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### 1๏ธโฃ ุฌุฏูู `user_statuses`
```sql
CREATE TYPE public.user_status AS ENUM (
  'publisher',      -- ูุงุดุฑ ุนุงุฏู (ุงูุชุฑุงุถู)
  'trusted_owner',  -- ูุงูู ููุซูู
  'office_agent'    -- ููุชุจ ุฏูุงููุฉ
);

CREATE TABLE public.user_statuses (
  user_id UUID PRIMARY KEY,
  status public.user_status DEFAULT 'publisher',  -- ููุน ุงูุญุณุงุจ
  can_publish BOOLEAN DEFAULT true,                -- ุตูุงุญูุฉ ุงููุดุฑ
  properties_limit INTEGER DEFAULT 1,              -- ุญุฏ ุงูุนูุงุฑุงุช
  images_limit INTEGER DEFAULT 2,                  -- ุญุฏ ุงูุตูุฑ
  is_verified BOOLEAN DEFAULT false                -- ููุซูุ
);
```

### ๐ ุงูููุงููู ุงูุฃุณุงุณูุฉ

#### `status` (ููุน ุงูุญุณุงุจ)
- **ุงูููู ุงููุณููุญุฉ**: `publisher` | `trusted_owner` | `office_agent`
- **ุงูุบุฑุถ**: ุชุตููู ุงููุณุชุฎุฏู ุญุณุจ ููุน ุญุณุงุจู
- **ูุง ูุชุบูุฑ ุนูุฏ ุงูุญุธุฑ**: ูุฐุง ุงูุญูู ุซุงุจุช ููุญุฏุฏ ููุน ุงููุณุชุฎุฏู

| ุงููููุฉ | ุงูุนุฑุจู | ุงูุฃููููุฉ | ุงููุตู |
|--------|---------|----------|-------|
| `publisher` | ูุงุดุฑ ุนุงุฏู | ๐ค | ูุณุชุฎุฏู ุนุงุฏู ููุดุฑ ุนูุงุฑุงุชู ุงูุฎุงุตุฉ |
| `trusted_owner` | ูุงูู ููุซูู | ๐ | ูุงูู ุนูุงุฑุงุช ููุซูู ุจุญุฏ ุฃุนูู |
| `office_agent` | ููุชุจ ุฏูุงููุฉ | ๐ข | ููุชุจ ุนูุงุฑุงุช ุจุตูุงุญูุงุช ุนุงููุฉ |

#### `can_publish` (ุตูุงุญูุฉ ุงููุดุฑ)
- **ุงูููู ุงููุณููุญุฉ**: `true` | `false`
- **ุงูุบุฑุถ**: ุงูุชุญูู ูู ูุฏุฑุฉ ุงููุณุชุฎุฏู ุนูู ุงููุดุฑ
- **ูุชุบูุฑ ุนูุฏ ุงูุญุธุฑ**: ูุฐุง ูุง ูุบูุฑู ุนูุฏ ุญุธุฑ/ุฅูุบุงุก ุญุธุฑ ุงููุณุชุฎุฏู

| ุงููููุฉ | ุงูุญุงูุฉ | ุงูุฃููููุฉ | ุงููุตู |
|--------|---------|----------|-------|
| `true` | ููููู ุงููุดุฑ | โ | ุงููุณุชุฎุฏู ูุณุชุทูุน ูุดุฑ ุนูุงุฑุงุช ุฌุฏูุฏุฉ |
| `false` | ูุญุธูุฑ | ๐ซ | ุงููุณุชุฎุฏู ููููุน ูู ุงููุดุฑ |

### ๐จ ุงูุนุฑุถ ูู ุงููุงุฌูุฉ

#### ูู **ุฌุฏูู ุงููุณุชุฎุฏููู** (ุงูุจุทุงูุงุช)
```tsx
<Badge variant={user.role === 'admin' ? "default" : "secondary"}>
  {user.role === 'admin' ? 'ูุฏูุฑ' : 'ูุณุชุฎุฏู'}
</Badge>

<Badge variant="secondary">
  {user.status === 'trusted_owner' ? '๐ ูุงูู ููุซูู' :
   user.status === 'office_agent' ? '๐ข ููุชุจ ุฏูุงููุฉ' :
   '๐ค ูุงุดุฑ'}
</Badge>

{user.can_publish === false && (
  <Badge variant="destructive">
    ๐ซ ูุญุธูุฑ
  </Badge>
)}
```

#### ูู **ุงููุงูุฐุฉ ุงูููุจุซูุฉ** (ุงูุชูุงุตูู)
```tsx
<div className="flex items-center gap-2">
  <span className="font-medium">ุงูุฏูุฑ:</span>
  <Badge variant={selectedUser.role === 'admin' ? 'default' : 'secondary'}>
    {selectedUser.role === 'admin' ? '๐ ูุฏูุฑ' : '๐ค ูุณุชุฎุฏู'}
  </Badge>
</div>

<div className="flex items-center gap-2">
  <span className="font-medium">ููุน ุงูุญุณุงุจ:</span>
  <Badge>
    {selectedUser.status === 'trusted_owner' ? '๐ ูุงูู ููุซูู' :
     selectedUser.status === 'office_agent' ? '๐ข ููุชุจ ุฏูุงููุฉ' :
     '๐ค ูุงุดุฑ ุนุงุฏู'}
  </Badge>
</div>

<div className="flex items-center gap-2">
  <span className="font-medium">ุญุงูุฉ ุงููุดุฑ:</span>
  <Badge variant={selectedUser.can_publish === false ? 'destructive' : 'default'}>
    {selectedUser.can_publish === false ? '๐ซ ูุญุธูุฑ ูู ุงููุดุฑ' : 'โ ููููู ุงููุดุฑ'}
  </Badge>
</div>

<div className="flex items-center gap-2">
  <span className="font-medium">ุญุฏ ุงูุนูุงุฑุงุช:</span>
  <span>{selectedUser.properties_count} / {selectedUser.properties_limit} ุนูุงุฑ</span>
</div>

<div className="flex items-center gap-2">
  <span className="font-medium">ุญุฏ ุงูุตูุฑ:</span>
  <span>{selectedUser.images_limit} ุตูุฑุฉ ููู ุนูุงุฑ</span>
</div>
```

### ๐ง ุงูููุทู ุงูุจุฑูุฌู

#### ุนูุฏ ุงูุญุธุฑ (`handleBanUser`)
```typescript
const handleBanUser = async () => {
  // 1. ุฅุฎูุงุก ุฌููุน ุนูุงุฑุงุช ุงููุณุชุฎุฏู
  await supabase
    .from('properties')
    .update({ is_published: false })
    .eq('user_id', selectedUser.id);

  // 2. ููุน ุงููุณุชุฎุฏู ูู ุงููุดุฑ
  await supabase
    .from('user_statuses')
    .upsert({
      user_id: selectedUser.id,
      can_publish: false,      // โ ููุน ุงููุดุฑ
      properties_limit: 0,      // โ ุตูุฑ ุนูุงุฑุงุช
      images_limit: 0,          // โ ุตูุฑ ุตูุฑ
      // โ๏ธ ูุง ูุบูุฑ status - ูุจูู ููุง ูู
    });
};
```

#### ุนูุฏ ุฅูุบุงุก ุงูุญุธุฑ (`handleUnbanUser`)
```typescript
const handleUnbanUser = async () => {
  await supabase
    .from('user_statuses')
    .upsert({
      user_id: selectedUser.id,
      can_publish: true,        // โ ุงูุณูุงุญ ุจุงููุดุฑ
      properties_limit: 10,     // โ ุฅุนุงุฏุฉ ุงูุญุฏ
      images_limit: 10,         // โ ุฅุนุงุฏุฉ ุงูุญุฏ
      // โ๏ธ ูุง ูุบูุฑ status - ูุจูู ููุง ูู
    });
};
```

#### ุฒุฑ ุงูุญุธุฑ/ุฅูุบุงุก ุงูุญุธุฑ
```typescript
{user.can_publish === false ? (
  <Button variant="outline" className="text-green-600 border-green-600">
    <Unlock className="h-4 w-4" />
    ุฅูุบุงุก ุญุธุฑ
  </Button>
) : (
  <Button variant="outline" className="text-orange-600 border-orange-600">
    <Ban className="h-4 w-4" />
    ุญุธุฑ
  </Button>
)}
```

## ๐ ูุตูููุฉ ุงูุชูุงูู

| ุงููููุน | role | status | can_publish | properties_count | ุงูุญุฏูุฏ |
|--------|------|--------|-------------|-----------------|--------|
| **ุฌุฏูู ุงููุณุชุฎุฏููู** | โ | โ | โ | โ | โ |
| **ุงููุงูุฐุฉ ุงูููุจุซูุฉ** | โ | โ | โ | โ | โ |
| **ุฒุฑ ุงูุญุธุฑ** | - | - | โ | - | - |
| **handleBanUser** | - | - | โ | - | โ |
| **handleUnbanUser** | - | - | โ | - | โ |

## ๐ฏ ุงูุณููุงุฑูููุงุช

### ุณููุงุฑูู 1: ุญุธุฑ ูุณุชุฎุฏู ุนุงุฏู
```
ูุจู ุงูุญุธุฑ:
- role: 'user'
- status: 'publisher'
- can_publish: true
- properties_limit: 1
- ุงูุนุฑุถ: "๐ค ูุงุดุฑ" + ุฒุฑ "ุญุธุฑ" ๐

ุจุนุฏ ุงูุญุธุฑ:
- role: 'user'
- status: 'publisher'  โ ูู ูุชุบูุฑ
- can_publish: false   โ ุชุบูุฑ โ
- properties_limit: 0  โ ุชุบูุฑ โ
- ุงูุนุฑุถ: "๐ค ูุงุดุฑ" + "๐ซ ูุญุธูุฑ" + ุฒุฑ "ุฅูุบุงุก ุญุธุฑ" ๐ข
```

### ุณููุงุฑูู 2: ุญุธุฑ ูุงูู ููุซูู
```
ูุจู ุงูุญุธุฑ:
- role: 'user'
- status: 'trusted_owner'
- can_publish: true
- properties_limit: 50
- ุงูุนุฑุถ: "๐ ูุงูู ููุซูู" + ุฒุฑ "ุญุธุฑ" ๐

ุจุนุฏ ุงูุญุธุฑ:
- role: 'user'
- status: 'trusted_owner'  โ ูู ูุชุบูุฑ
- can_publish: false       โ ุชุบูุฑ โ
- properties_limit: 0      โ ุชุบูุฑ โ
- ุงูุนุฑุถ: "๐ ูุงูู ููุซูู" + "๐ซ ูุญุธูุฑ" + ุฒุฑ "ุฅูุบุงุก ุญุธุฑ" ๐ข
```

### ุณููุงุฑูู 3: ุฅูุบุงุก ุญุธุฑ ููุชุจ ุฏูุงููุฉ
```
ูุจู ุฅูุบุงุก ุงูุญุธุฑ:
- role: 'user'
- status: 'office_agent'
- can_publish: false
- properties_limit: 0
- ุงูุนุฑุถ: "๐ข ููุชุจ ุฏูุงููุฉ" + "๐ซ ูุญุธูุฑ" + ุฒุฑ "ุฅูุบุงุก ุญุธุฑ" ๐ข

ุจุนุฏ ุฅูุบุงุก ุงูุญุธุฑ:
- role: 'user'
- status: 'office_agent'  โ ูู ูุชุบูุฑ
- can_publish: true       โ ุชุบูุฑ โ
- properties_limit: 10    โ ุชุบูุฑ โ
- ุงูุนุฑุถ: "๐ข ููุชุจ ุฏูุงููุฉ" + ุฒุฑ "ุญุธุฑ" ๐
```

## โ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### ูุง ุชู ุชุญูููู:
1. โ **ุชูุญูุฏ ุงูููุทู**: ูู ูู ุงูุฌุฏูู ูุงููุงูุฐุฉ ุงูููุจุซูุฉ ูุนุฑุถุงู ููุณ ุงููุนูููุงุช
2. โ **ูุตู ุงูููุงููู**:
   - `status` = ููุน ุงูุญุณุงุจ (ุซุงุจุช)
   - `can_publish` = ุตูุงุญูุฉ ุงููุดุฑ (ูุชุบูุฑ)
3. โ **ูุถูุญ ุงูุนุฑุถ**: ุฅูููุฌู + ูุตูุต ูุงุถุญุฉ + ุฃููุงู ูููุฒุฉ
4. โ **ุชูุงุตูู ุฃูุซุฑ**: ุฅุถุงูุฉ ุญุฏ ุงูุตูุฑ ูุนุฏุฏ ุงูุนูุงุฑุงุช
5. โ **ุชุทุงุจู ุชุงู**: ุงููุงูุฐุฉ ุงูููุจุซูุฉ ุชุนูุณ ูุง ูู ุงูุฌุฏูู ุจุฏูุฉ

### ุงูุชุญุณููุงุช:
- ๐จ ุฅุถุงูุฉ ุฅูููุฌู ููู ููุน ุญุณุงุจ
- ๐ ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช (ุนุฏุฏ/ุญุฏ ุงูุนูุงุฑุงุช ูุงูุตูุฑ)
- ๐ฏ Badge ูููุตู ูุญุงูุฉ ุงูุญุธุฑ
- โจ ุฃููุงู ูุงุถุญุฉ (ุฃุญูุฑ ููุญุธุฑุ ุฃุฎุถุฑ ูุฅูุบุงุก ุงูุญุธุฑ)

---
**ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** ${new Date().toLocaleDateString('ar-EG')}  
**ุงูุญุงูุฉ:** โ ููุชูู ููุชูุงูู ุจูุณุจุฉ 100%
